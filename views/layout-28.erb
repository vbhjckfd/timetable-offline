<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Creator: CorelDRAW 2019 (64-Bit) -->
<svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" width="5906px" height="4134px" version="1.1" style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
 <defs>
  <style type="text/css">
   <![CDATA[
    <%= erb :fonts %>
    .str0 {stroke:#9D9E9E;stroke-width:2.36;stroke-miterlimit:22.9256}
    .fil0 {fill:none}
    .fil8 {fill:#FEFEFE}
    .fil5 {fill:#FFED00}
    .fil9 {fill:#E42D24}
    .fil14 {fill:#E31E24}
    .fil15 {fill:#2B2A29}
    .fil13 {fill:#2B2A29}
    .fil1 {fill:#7D8A92}
    .fil10 {fill:#954592}
    .fil7 {fill:#1CBBEE}
    .fil11 {fill:#26602C}
    .fil2 {fill:#0E4F95}
    .fil4 {fill:#000066}
    .fil3 {fill:#FEFEFE;fill-rule:nonzero}
    .fil6 {fill:#FFED00;fill-rule:nonzero}
    .fil12 {fill:#7D8A92;fill-rule:nonzero}

    .footer .fil7 {fill:#2B2A29}
    .footer .fil8 {fill:#E31E24}
<<<<<<< HEAD

    .footer .fnt0 {font-weight:600;font-size:416.7px;font-family:'Myriad Pro'}
    .footer .fnt1 {font-weight:normal;font-size:100.01px;font-family:'Myriad Pro Light'}

=======
>>>>>>> origin/master
   ]]>
  </style>
 </defs>

 <% let_transport = transfers[:tram] || transfers[:trol] %>
 <% xs = [1240.26, 1919.45, 2598.64, 3278.65, 3957.84, 4637.03, 5315.4] %>
 <% buses_in_3_lines = transfers[:bus] && transfers[:bus].length > 14 %>
 <% buses_in_1_line = transfers[:bus] && transfers[:bus].length > 0 && transfers[:bus].length < 8 %>
 <% total_lines = [let_transport.nil? ? 0 : 1, transfers[:bus] ? (transfers[:bus].length.to_f / 7).ceil : 0, transfers[:night] ? 1 : 0 ].inject(0, :+) %>

 <%
  verticals = {let: 0, bus: 0, night: 0}

  if (buses_in_3_lines)
    verticals[:night] = 714.63
  end

  if (let_transport.nil?)
    verticals.merge!({
      bus: -1240.24 + 531.54,
      night: -2663.59 + 1240.24 + (buses_in_1_line ? 0 : 714.63),
    })
  end

  if (!let_transport.nil? && buses_in_1_line)
    verticals.merge!({
      night: -2663.59 + 1240.24 + 714.63,
    })
  end

 %>

  <% if !let_transport.nil? %>
    <g id="let-group" transform="translate(0, <% verticals[:let] %>)">
      <% if transfers[:tram] %>
        <path class="fil12" d="M581.16 810.87l-158.3 0c-7.77,0.18 -13.93,6.62 -13.75,14.39 0.17,7.52 6.23,13.58 13.75,13.75l158.3 0c7.77,0.18 14.21,-5.98 14.39,-13.75 0.17,-7.77 -5.98,-14.21 -13.75,-14.39 -0.21,0 -0.43,0 -0.64,0z"/>
        <path class="fil12" d="M384.54 368.26l234.59 0 48.64 157.34 -18.05 91.31 -296.28 0 -17.16 -91.36 48.26 -157.29zm333.44 157.31l0 -0.02c-0.1,-0.36 -53.4,-183.91 -53.48,-184.41 -2.39,-11.42 -13.13,-24.4 -27.41,-24.4 -13.44,-0.46 -104.98,0 -104.98,0l64.07 -64.92c7.81,-7.82 7.81,-20.5 0,-28.32l-45.54 -45.49 -28.25 -26.05c-5.44,-5.33 -12.75,-8.32 -20.37,-8.36 -7.61,0.11 -14.92,3 -20.55,8.14l-28.05 26.27 -45.53 45.49c-7.82,7.82 -7.82,20.49 0,28.31l64.07 64.92c0,0 -94.11,-0.29 -104.6,0 -13.5,0 -28.02,16.54 -30.51,31.37 -0.15,0.89 -50.81,177.44 -50.81,177.44l32.26 180.12c3.99,22.63 17.81,39.78 39.74,39.78l287.92 0c21.97,0 35.42,-12.94 39.76,-39.76l32.26 -180.11zm-275.6 -287.89l59.65 -59.65 59.65 59.65 -59.65 59.65 -59.65 -59.65zm165.6 463.36c-15.5,-0.01 -28.05,-12.58 -28.04,-28.08 0.01,-15.49 12.58,-28.04 28.08,-28.03 15.49,0.01 28.05,12.58 28.03,28.08 0.01,15.46 -12.52,28.01 -27.99,28.02 -0.02,0 -0.04,0 -0.06,0l-0.02 0.01zm-212.01 0c-15.49,0.01 -28.06,-12.54 -28.07,-28.03 -0.02,-15.5 12.54,-28.07 28.03,-28.08 15.49,-0.01 28.07,12.54 28.08,28.03 0,0.02 0,0.03 0,0.05 -0.02,15.46 -12.55,28 -28.01,28.02l-0.03 0.01z"/>
        <path class="fil12" d="M364.95 772.15l-61.73 61.96c-8.91,8.91 -8.91,23.35 0,32.26 8.92,8.91 23.36,8.91 32.27,0l94.28 -94.22 -64.82 0z"/>
        <path class="fil12" d="M639.1 772.15l-64.83 0 94.29 94.23c4.44,4.44 10.26,6.67 16.08,6.68l0.11 0c5.82,-0.01 11.64,-2.24 16.08,-6.68 8.91,-8.91 8.91,-23.35 0,-32.26l0 0 -61.73 -61.97z"/>
      <% elsif transfers[:trol] %>
        <image xlink:href="/icons/ico-trolleybus.svg" x="287.8000183105469" y="236.26" width="428.4" height="631.51"/>
      <% end %>

      <% let_transport.each_with_index do |r, index| %>
          <image xlink:href="/icons/<%= r['route_normalized'] %>.svg" x="<%= xs[index] - 295.28 %>" y="<%= 531.54 - 295.28 %>" width="590.53" height="590.53"/>
      <% end %>
    </g>
  <% end %>

  <% if transfers[:bus] %>
    <g id="bus-group" transform="translate(0, <%= verticals[:bus] %>)">
      <path id="bus-icon" class="fil1" d="M676.63 1000.29l-349.24 0c-21.85,0 -39.59,17.72 -39.59,39.6l0 349.19c0,21.88 17.74,39.64 39.59,39.64l12.25 0 0 15.23c0,20.01 16.22,36.28 36.29,36.28l4.24 0c20.02,0 36.27,-16.27 36.27,-36.28l0 -15.23 174.62 0 0 15.23c0,20.01 16.25,36.28 36.32,36.28l4.23 0c20.05,0 36.3,-16.27 36.3,-36.28l0 -15.23 8.72 0c21.85,0 39.59,-17.76 39.59,-39.64l0 -349.19c0.01,-21.88 -17.74,-39.6 -39.59,-39.6zm-311.43 384.19c-15.4,0 -27.91,-12.54 -27.91,-27.94 0,-15.44 12.51,-27.93 27.91,-27.93 15.46,0 27.98,12.49 27.98,27.93 0,15.4 -12.52,27.94 -27.98,27.94zm272.99 0c-15.42,0 -27.93,-12.54 -27.93,-27.94 0,-15.44 12.51,-27.93 27.93,-27.93 15.47,0 27.96,12.49 27.96,27.93 0,15.4 -12.5,27.94 -27.96,27.94zm27.96 -83.81l-328.3 0 0 -251.49 328.3 0 0 251.49z"/>

      <% bus_y = [1240.24, 1948.96, 2663.59] %>
      <% transfers[:bus].each_with_index do |r, index| %>
          <% row_number = (index / 7).to_i %>
          <% col_number = index % 7; %>

          <image xlink:href="/icons/<%= r['route_normalized'] %>.svg" x="<%= xs[col_number] - 295.28 %>" y="<%= bus_y[row_number] - 295.28 %>" width="590.53" height="590.53"/>
      <% end %>
    </g>
  <% end %>

  <% if transfers[:night] %>
    <g id="night-group" transform="translate(0, <%= verticals[:night] %>)">
      <path class="fil1" d="M676.63 2453.17l-349.24 0c-21.86,0 -39.6,17.72 -39.6,39.6l0 349.19c0,21.87 17.74,39.64 39.6,39.64l12.25 0 0 15.23c0,20 16.22,36.27 36.29,36.27l4.23 0c20.03,0 36.28,-16.27 36.28,-36.27l0 -15.23 174.62 0 0 15.23c0,20 16.25,36.27 36.32,36.27l4.23 0c20.05,0 36.3,-16.27 36.3,-36.27l0 -15.23 8.72 0c21.85,0 39.59,-17.77 39.59,-39.64l0 -349.19c0,-21.88 -17.74,-39.6 -39.59,-39.6zm-311.43 384.18c-15.4,0 -27.91,-12.53 -27.91,-27.93 0,-15.44 12.51,-27.94 27.91,-27.94 15.46,0 27.98,12.5 27.98,27.94 0,15.4 -12.52,27.93 -27.98,27.93zm272.99 0c-15.42,0 -27.93,-12.53 -27.93,-27.93 0,-15.44 12.51,-27.94 27.93,-27.94 15.46,0 27.96,12.5 27.96,27.94 0,15.4 -12.5,27.93 -27.96,27.93zm27.96 -83.8l-328.3 0 0 -251.49 328.3 0 0 251.49z"/>
      <path class="fil1" d="M941.34 2394.76c-14.21,58.03 -66.56,101.09 -128.97,101.09 -73.33,0 -132.78,-59.45 -132.78,-132.78 0,-62.41 43.06,-114.76 101.09,-128.97 -30.07,20.84 -49.77,55.6 -49.77,94.95 0,63.78 51.7,115.48 115.47,115.48 39.36,0 74.11,-19.7 94.96,-49.77z"/>

      <% transfers[:night].each_with_index do |r, index| %>
          <image xlink:href="/icons/<%= r['route_normalized'] %>.svg" x="<%= xs[index] - 295.28 %>" y="<%= 2663.59 - 295.28 %>" width="590.53" height="590.53"/>
      <% end %>

    </g>
  <% end %>



      <%= erb :footer, :locals => {data: data, qrcode: qrcode} %>


</svg>
